# Integration tests for California Income Tax
# Tests RTC ยง 17041 (income tax) and ยง 17043 (MHS tax)

test_suite: ca_income_tax
description: California personal income tax calculations

tests:
  # Single filer tests
  - name: single_10k_taxable_income
    description: Single filer with $10,000 taxable income (1% bracket only)
    inputs:
      filing_status: single
      taxable_income: 10000
    expected:
      ca_income_tax: 100.00
      mhs_tax: 0.00
      total_tax: 100.00

  - name: single_25k_taxable_income
    description: Single filer with $25,000 taxable income (1% and 2% brackets)
    inputs:
      filing_status: single
      taxable_income: 25000
    expected:
      ca_income_tax: 392.44
      # 10,756 * 0.01 + (25,000 - 10,756) * 0.02 = 107.56 + 284.88
      mhs_tax: 0.00

  - name: single_75k_taxable_income
    description: Single filer with $75,000 taxable income
    inputs:
      filing_status: single
      taxable_income: 75000
    expected:
      ca_income_tax: 3517.36
      # Tax at 70,606 = 3,108.72 + (75,000 - 70,606) * 0.093 = 3,517.36
      mhs_tax: 0.00

  - name: single_millionaire
    description: Single filer with $1.5M taxable income (MHS tax applies)
    inputs:
      filing_status: single
      taxable_income: 1500000
    expected:
      mhs_tax: 5000.00
      # (1,500,000 - 1,000,000) * 0.01 = 5,000

  # Married filing jointly tests
  - name: mfj_50k_taxable_income
    description: MFJ with $50,000 taxable income
    inputs:
      filing_status: married_filing_jointly
      taxable_income: 50000
    expected:
      ca_income_tax: 764.88
      # 21,512 * 0.01 + (50,000 - 21,512) * 0.02

  - name: mfj_150k_taxable_income
    description: MFJ with $150,000 taxable income
    inputs:
      filing_status: married_filing_jointly
      taxable_income: 150000
    expected:
      ca_income_tax: 7034.63
      # Tax at 141,212 = 6,217.44 + (150,000 - 141,212) * 0.093

  # Head of household tests
  - name: hoh_40k_taxable_income
    description: Head of household with $40,000 taxable income
    inputs:
      filing_status: head_of_household
      taxable_income: 40000
    expected:
      ca_income_tax: 558.19

  # Standard deduction tests
  - name: standard_deduction_single
    description: Single filer standard deduction
    inputs:
      filing_status: single
    expected:
      standard_deduction: 5540

  - name: standard_deduction_mfj
    description: MFJ standard deduction
    inputs:
      filing_status: married_filing_jointly
    expected:
      standard_deduction: 11080
